import { Story, Preview } from '@storybook/addon-docs/blocks';
import { action } from '@storybook/addon-actions';
import { VictoryPie, Slice, VictoryErrorBar } from 'victory';

# Storybook Docs

Let's explore the Storybook Docs prototype.

## MDX

Storybook Docs allows you to mix stories and documentation in
[MDX format](https://mdxjs.com/).

MDX combines Markdown and JSX. Cool.

## Victory

We'll be writing stories for the PieChart component in
[Victory](https://formidable.com/open-source/victory/).

## Component Declaration

First we declare our component.

export const componentMeta = {
  title: 'MDX|Victory',
  component: VictoryPie,
  decorators: [getStory => <div style={{ width: 400, height: 400 }}>{getStory()}</div>],
};

This export doesn't show up in the MDX output.

## ComponentMeta SB5 Equivalent

This is roughly equivalent to SB5’s `storiesOf`:

```
storiesOf('MDX|Victory', module)
  .addParameter({ component: VictoryPie })
  .addDecorator(getStory => <div style={{ width: 400, height: 400 }}>{getStory()}</div>)
```

## Story Declaration

Next we can create stories.

<Story name="by default">
  <VictoryPie />
</Story>

## Docs Module format

When we write this MDX, the doc story gets compiled to the following
`module` format:

```js
export const byDefault = () => <VictoryPie />;
byDefault.title = 'by default';
```

This is a portable format that's easy to reuse in other tools.
For example, to create Jest test cases.

## Story SB5 Equivalent

The module format, in turn, is equivalent to:

```
storiesOf(...)
  .add('by default', () => <VictoryPie />);
```

## More stories

And of course we can add as many stories in the same way.

Adding a new story updates the UI.

<Story name="fancy">
  <VictoryPie
    style={{
      labels: {
        fill: 'white',
        fontSize: 12,
        fontWeight: 'bold',
      },
    }}
    data={[
      { x: '<5', y: 6279 },
      { x: '5-13', y: 9182 },
      { x: '14-17', y: 5511 },
      { x: '18-24', y: 7164 },
      { x: '25-44', y: 6716 },
      { x: '45-64', y: 4263 },
      { x: '≥65', y: 7502 },
    ]}
    innerRadius={90}
    labelRadius={110}
    colorScale={['#D85F49', '#F66D3B', '#D92E1D', '#D73C4C', '#FFAF59', '#E28300', '#F6A57F']}
  />
</Story>

## Addon compatibility

Docs stories are compatible with addons.

For example, this one uses `addon-actions`.

<Story name="interactive">
  <VictoryPie
    data={[{ x: 'Cat', y: 62 }, { x: 'Dog', y: 91 }, { x: 'Fish', y: 55 }, { x: 'Bird', y: 55 }]}
    events={[
      {
        target: 'data',
        eventHandlers: {
          onClick: (event, props) => {
            action('click a slice of pie')();
            const fill = props.style.fill;
            return {
              mutation: () => {
                return fill === 'red' ? null : { style: { fill: 'red' } };
              },
            };
          },
        },
      },
    ]}
  />
</Story>

## Documentation

In addition to Storybook stories, the above code has also created
**long-form documentation** aka Docs.

Docs also updates in the browser when you edit it.
_Sweeeeet_.

## React Components

This is MDX, so we can add arbitrary React code as well:

<VictoryErrorBar />

This doesn't show up as a story, but it shows up in the docs.

## Story

We can also embed other stories in our docs wherever we want
with the `Story` component by using the `id` parameter.

<Story id="mdx-button--with-icons" />

## More Info

For more info, check out the [Storybook Docs RFC](https://docs.google.com/document/d/1D4Ov4UvrB80Uy1CLGshbFEWQKWEpr8dL4FmOqRDwjwI/edit?usp=sharing).

This document also linked in the description below.

Feedback welcome!
